<!DOCTYPE html>
<html lang= "en-us"><head>
  <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon-16x16.png">
  <link rel="manifest" href="/img/site.webmanifest">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
  <meta name="referrer" content="always">
	<meta name="description" content="Early last week, I broke my five-year rule of not upgrading to a newly released version of macOS until after two minor dot releases for the first time. As with every new operating system upgrade, this new update broke many of the packages I use daily. A major one being pyenv, a tool I use for building and managing various versions of the Python programming language. After upgrading, I tried building Python 3.8.6 with pyenv only to receive the following error messages. ">
	<link rel="canonical" href="http://retornam.com/2020/11/building-python-on-macos-big-sur/">
	<meta property="og:url" content="http://retornam.com/2020/11/building-python-on-macos-big-sur/">
  <meta property="og:site_name" content="Raymond Etornam">
  <meta property="og:title" content="Building Python on MacOS Big Sur">
  <meta property="og:description" content="Early last week, I broke my five-year rule of not upgrading to a newly released version of macOS until after two minor dot releases for the first time. As with every new operating system upgrade, this new update broke many of the packages I use daily. A major one being pyenv, a tool I use for building and managing various versions of the Python programming language. After upgrading, I tried building Python 3.8.6 with pyenv only to receive the following error messages.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-11-18T09:06:03-08:00">
    <meta property="article:modified_time" content="2020-11-18T09:06:03-08:00">

	
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Building Python on MacOS Big Sur">
  <meta name="twitter:description" content="Early last week, I broke my five-year rule of not upgrading to a newly released version of macOS until after two minor dot releases for the first time. As with every new operating system upgrade, this new update broke many of the packages I use daily. A major one being pyenv, a tool I use for building and managing various versions of the Python programming language. After upgrading, I tried building Python 3.8.6 with pyenv only to receive the following error messages.">

	<link rel="icon" href="/img/favicon.ico">
	<link rel="stylesheet" type="text/css" href="/css/gruvbox-dark.css">
	<link rel="stylesheet" type="text/css" href="/css/hack.css">
	<title>
		  Building Python on MacOS Big Sur |   Raymond Etornam
	</title>
</head>


<body class="snow hack gruvbox-dark">
    	<div class="container"><header>
	<p>
		<a href="/">Raymond Etornam</a>
		 - 
		<a href="/posts">Posts</a>
		 - 
		<a href="/about">About</a>
	</p>
</header><div class="newframe">
    			<main>
  <h1> Building Python on MacOS Big Sur</h1>
  <p><time> November 18, 2020</time><p>
 <p>Early last week, I broke my five-year rule of not upgrading to a newly released version of macOS until after two minor dot releases for the first time. As with every new operating system upgrade, this new update broke many of the packages I use daily. A major one being pyenv, a tool I use for building and managing various versions of the Python programming language. After upgrading, I tried building Python 3.8.6 with pyenv only to receive the following error messages.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➜</span> pyenv install <span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>python<span style="color:#f92672">-</span>build: use openssl<span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">1.1</span> from homebrew
</span></span><span style="display:flex;"><span>python<span style="color:#f92672">-</span>build: use readline from homebrew
</span></span><span style="display:flex;"><span>Downloading Python<span style="color:#f92672">-</span><span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6.</span>tar<span style="color:#f92672">.</span>xz<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>python<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>ftp<span style="color:#f92672">/</span>python<span style="color:#f92672">/</span><span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6</span><span style="color:#f92672">/</span>Python<span style="color:#f92672">-</span><span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6.</span>tar<span style="color:#f92672">.</span>xz
</span></span><span style="display:flex;"><span>Installing Python<span style="color:#f92672">-</span><span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6.</span><span style="color:#f92672">..</span>
</span></span><span style="display:flex;"><span>python<span style="color:#f92672">-</span>build: use readline from homebrew
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>import pip<span style="color:#f92672">.</span>_internal
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">File</span> <span style="color:#e6db74">&#34;&lt;frozen zipimport&gt;&#34;</span>, line <span style="color:#ae81ff">241</span>, <span style="color:#f92672">in</span> load_module
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">File</span> <span style="color:#e6db74">&#34;&lt;frozen zipimport&gt;&#34;</span>, line <span style="color:#ae81ff">709</span>, <span style="color:#f92672">in</span> _get_module_code
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">File</span> <span style="color:#e6db74">&#34;&lt;frozen zipimport&gt;&#34;</span>, line <span style="color:#ae81ff">570</span>, <span style="color:#f92672">in</span> _get_data
</span></span><span style="display:flex;"><span>BUILD FAILED (<span style="color:#a6e22e">OS</span> X <span style="color:#ae81ff">11.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span> using python<span style="color:#f92672">-</span>build <span style="color:#ae81ff">20180424</span>)
</span></span><span style="display:flex;"><span>zipimport<span style="color:#f92672">.</span>ZipImportError: can<span style="color:#e6db74">&#39;t decompress data; zlib not available</span>
</span></span></code></pre></div><p>Even though I had updated to the latest versions of both XCode and XCode command-line tools, pyenv&rsquo;s python-build process was unable to locate the header files for zlib.</p>
<p>Next, I tried exporting the path to the header files using the CFLAGS and LDFLAGS environment variables</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-gdscript3" data-lang="gdscript3"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">➜</span> CFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-I$(xcrun --show-sdk-path)/usr/include&#34;</span> LDFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34; -L$(xcrun --show-sdk-path)/usr/lib&#34;</span> pyenv install <span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>python<span style="color:#f92672">-</span>build: use openssl<span style="color:#960050;background-color:#1e0010">@</span><span style="color:#ae81ff">1.1</span> from homebrew
</span></span><span style="display:flex;"><span>python<span style="color:#f92672">-</span>build: use readline from homebrew
</span></span><span style="display:flex;"><span>Downloading Python<span style="color:#f92672">-</span><span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6.</span>tar<span style="color:#f92672">.</span>xz<span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-&gt;</span> https:<span style="color:#f92672">//</span>www<span style="color:#f92672">.</span>python<span style="color:#f92672">.</span>org<span style="color:#f92672">/</span>ftp<span style="color:#f92672">/</span>python<span style="color:#f92672">/</span><span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6</span><span style="color:#f92672">/</span>Python<span style="color:#f92672">-</span><span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6.</span>tar<span style="color:#f92672">.</span>xz
</span></span><span style="display:flex;"><span>Installing Python<span style="color:#f92672">-</span><span style="color:#ae81ff">3.8</span><span style="color:#f92672">.</span><span style="color:#ae81ff">6.</span><span style="color:#f92672">..</span>
</span></span><span style="display:flex;"><span>python<span style="color:#f92672">-</span>build: use readline from homebrew
</span></span><span style="display:flex;"><span>python<span style="color:#f92672">-</span>build: use zlib from xcode sdk
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>import pip<span style="color:#f92672">.</span>_internal
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">File</span> <span style="color:#e6db74">&#34;&lt;frozen zipimport&gt;&#34;</span>, line <span style="color:#ae81ff">241</span>, <span style="color:#f92672">in</span> load_module
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">File</span> <span style="color:#e6db74">&#34;&lt;frozen zipimport&gt;&#34;</span>, line <span style="color:#ae81ff">709</span>, <span style="color:#f92672">in</span> _get_module_code
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">File</span> <span style="color:#e6db74">&#34;&lt;frozen zipimport&gt;&#34;</span>, line <span style="color:#ae81ff">570</span>, <span style="color:#f92672">in</span> _get_data
</span></span><span style="display:flex;"><span>BUILD FAILED (<span style="color:#a6e22e">OS</span> X <span style="color:#ae81ff">11.0</span><span style="color:#f92672">.</span><span style="color:#ae81ff">1</span> using python<span style="color:#f92672">-</span>build <span style="color:#ae81ff">20180424</span>)
</span></span><span style="display:flex;"><span>zipimport<span style="color:#f92672">.</span>ZipImportError: can<span style="color:#e6db74">&#39;t decompress data; zlib not available</span>
</span></span></code></pre></div><p>Even with the added exports, the build was unable to locate zlib files. I decided to skip using the zlib files provided
by XCode next, by installing zlib using Homebew and then exporting the new
path to LDFLAGS, CFLAGS, and CPPFLAGS before issuing the build command.</p>
<p>If this is your first time using <a href="https://brew.sh">Homebrew</a>, follow the prompts to install openssl, sqlite, readline, bzip2, and zlib as kegs. Do not link the packages to your /usr/local or /usr/local/opt directories as this could cause potential
issues in the future.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>➜ brew install openssl sqlite readline bzip2 zlib
</span></span></code></pre></div><p>After the above command exits successfully, execute the following command to build Python with pyenv.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>➜ CFLAGS=&#34;-I$(brew --prefix openssl)/include -I$(brew --prefix bzip2)/include -I$(brew --prefix readline)/include -I$(xcrun --show-sdk-path)/usr/include&#34; LDFLAGS=&#34;-L$(brew --prefix openssl)/lib -L$(brew --prefix readline)/lib -L$(brew --prefix zlib)/lib -L$(brew --prefix bzip2)/lib&#34; CPPFLAGS=&#34;-I/usr/local/opt/bzip2/include&#34; pyenv install 3.8.6
</span></span></code></pre></div>

    			</main>
    		</div></div>
        
    </body>
</html>
